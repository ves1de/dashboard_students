<!DOCTYPE html>
<html lang="ru">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title><%= title %></title>
	<link rel="stylesheet" href="/style.css" />
</head>
<body>
<header>
	<div>–î–∞—à–±–æ—Ä–¥ —Å—Ç—É–¥–µ–Ω—Ç–∞</div>
	<div class="nav">
		<form class="inline" method="get" action="/dashboard" style="display:flex;align-items:center;gap:8px;">
			<input type="hidden" name="offset" value="<%= offset %>">
			<button class="btn secondary" name="dir" value="prev">¬´</button>
			<input type="number" name="amount" value="<%= amount || 1 %>" min="1" style="width:64px">
			<span><small class="muted">–ù–µ–¥–µ–ª—è: <%= weekRangeLabel %></small></span>
			<button class="btn secondary" name="dir" value="next">¬ª</button>
		</form>
		<button class="btn link" id="themeToggle" type="button" title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">üåô</button>
		<a href="https://uni-dubna.ru/" target="_blank" rel="noopener" class="btn link">–£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç</a>
		<span><small class="muted"><%= currentUser.fullName %> ‚Ä¢ <%= currentUser.groupName %></small></span>
		<a href="/logout">–í—ã–π—Ç–∏</a>
	</div>
</header>
<div class="container">
	<div class="grid">
		<div class="card">
			<div class="section-title"><h3>1. –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</h3></div>
			<% const dayOrder = ['mon','tue','wed','thu','fri','sat','sun']; const dayLabel = {mon:'–ü–Ω',tue:'–í—Ç',wed:'–°—Ä',thu:'–ß—Ç',fri:'–ü—Ç',sat:'–°–±',sun:'–í—Å'}; %>
			<% dayOrder.forEach(d => { const items = schedule.filter(s => s.dayOfWeek === d); if (!items.length) return; %>
				<h4><%= dayLabel[d] %></h4>
				<table class="table">
					<thead><tr><th>–ü–∞—Ä–∞</th><th>–û–ø–∏—Å–∞–Ω–∏–µ</th></tr></thead>
					<tbody>
						<% items.forEach((it, idx) => { %>
							<tr>
								<td><%= (idx + 1) %> –ø–∞—Ä–∞</td>
								<td>
									<strong><%= it.subject %></strong>
									<small class="muted"> ‚Ä¢ <%= it.room || '–∞—É–¥.?' %> ‚Ä¢ <%= it.teacherName || '–ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å?' %> ‚Ä¢ (<%= it.startTime %> - <%= it.endTime %>)</small>
								</td>
							</tr>
						<% }) %>
					</tbody>
				</table>
			<% }) %>
		</div>
		<div class="card">
			<div class="section-title"><h3>2. –î–ó</h3></div>
			<% if (!assignments.length) { %>
				<p><small class="muted">–ü–æ–∫–∞ –Ω–µ—Ç –∑–∞–¥–∞–Ω–∏–π –≤ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é</small></p>
			<% } %>
			<% assignments.forEach(a => { %>
				<div style="border-bottom:1px solid #eee; padding:8px 0;">
					<div><strong><%= a.homework %></strong></div>
					<small class="muted"><%= a.displaySubject %> ‚Ä¢ <%= a.groupName %> ‚Ä¢ <%= a.dayOfWeek %> ‚Ä¢ <%= a.startTime %>-<%= a.endTime %></small>
					<div><small class="muted">–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å: <%= a.teacherFullName || (a.teacherName || '') %> <%= a.teacherEmail ? '(' + a.teacherEmail + ')' : '' %></small></div>
					<% if (a.createdAt) { %><div><small class="muted">–î–æ–±–∞–≤–ª–µ–Ω–æ: <%= new Date(a.createdAt).toLocaleString() %></small></div><% } %>
				</div>
			<% }) %>
		</div>
		<div class="card">
			<div class="section-title"><h3>3. –î–µ–¥–ª–∞–π–Ω—ã</h3></div>
			<% if (!assignments.length) { %>
				<p><small class="muted">–ù–µ—Ç –¥–µ–¥–ª–∞–π–Ω–æ–≤ –≤ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é</small></p>
			<% } %>
			<% assignments.forEach(a => { %>
				<div style="border-bottom:1px solid #eee; padding:8px 0;">
					<div>–°—Ä–æ–∫: <strong><%= new Date(a.dueDate).toLocaleString() %></strong></div>
					<% if (a.extendedDueDate) { %>
						<div>–î–æ–ø. —Å—Ä–æ–∫: <strong><%= new Date(a.extendedDueDate).toLocaleString() %></strong> <%= a.extendedPenalty ? '(—à—Ç—Ä–∞—Ñ: -' + a.extendedPenalty + ' –±.)' : '' %></div>
					<% } %>
					<small class="muted"><%= a.homework %></small>
				</div>
			<% }) %>
		</div>
		<div class="card">
			<div class="section-title"><h3>4. –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</h3></div>
			<% if (!events.length) { %>
				<p><small class="muted">–ü–æ–∫–∞ –Ω–µ—Ç –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –≤ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é</small></p>
			<% } %>
			<% events.forEach(e => { %>
				<div style="border-bottom:1px solid #eee; padding:8px 0;">
					<div><strong><%= e.title %></strong></div>
					<div><small class="muted"><%= e.date %> ‚Ä¢ <%= e.startTime %>-<%= e.endTime %></small></div>
					<% if (e.subject) { %><div><span class="badge"><%= e.subject %></span> <small class="muted">/ <%= e.groupName || '–≤—Å–µ –≥—Ä—É–ø–ø—ã' %></small></div><% } %>
					<% if (e.description) { %><div><small><%= e.description %></small></div><% } %>
					<% if (e.createdAt) { %><div><small class="muted">–î–æ–±–∞–≤–ª–µ–Ω–æ: <%= e.createdAt %></small></div><% } %>
				</div>
			<% }) %>
		</div>
	</div>
</div>
<script src="/theme.js"></script>
</body>
</html>
